DESPATCH REGISTER FOR CUTTACK-JD ALL VEHICLES PERIOD 01/04/2022 TO 04/04/2022
Date  Truck No        Lc No   Company      Destination Inv No     Date  LR No   Weight    Qty  Freight Truck Fr  Advance  V.No   Balance    Other   TDS AMT  V.Dt  V.No  Remark               Deli  Ack.  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
02/04 OD05AF 7933         1   HORLICKS     CUTTACK-JD  9221000007 02/04          0.046      5     0.00
02/04 OD05AF 7933         1   DETERGENT&PP CUTTACK-JD  9221000008 02/04          2.862    280     0.00
02/04 OD05AF 7933         1   HORLICKS     CUTTACK-JD  9221000009 02/04          0.014      1     0.00
02/04 OD05AF 7933         1   TEA & FOODS  CUTTACK-JD  9221000010 02/04          0.471     37     0.00
02/04 OD05AF 7933         1   LAKME        CUTTACK-JD  9221000011 02/04          0.019     50     0.00
02/04 OD05AF 7933         1   MAIN LINE,PP CUTTACK-JD  9221000013 02/04          1.899    270     0.00
02/04 OD05AF 7933         1   HORLICKS     CUTTACK-JD  9001000014 02/04          0.095     10     0.00
                                                                    TOTAL :    5.406    653     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
02/04 OD05Z 0825          2   HORLICKS     KONARK      9221000026 02/04          0.277     18     0.00
02/04 OD05Z 0825          2   MAIN LINE,PP KONARK      9221000027 02/04          8.593    854     0.00
02/04 OD05Z 0825          2   KISSAN       KONARK      9221000028 02/04          0.524     45     0.00
02/04 OD05Z 0825          2   KISSAN       KONARK      9221000029 02/04          0.024      1     0.00
                                                                    TOTAL :    9.418    918     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
02/04 OR04B 6951          3   HORLICKS     BBSR=HD     9221000021 02/04          0.061      6     0.00
02/04 OR04B 6951          3   TEA & FOODS  BBSR=HD     9221000022 02/04          0.035      6     0.00
02/04 OR04B 6951          3   PP           BBSR=HD     9221000030 02/04          0.257     46     0.00
02/04 OR04B 6951          3   HORLICKS     BBSR=HD     9221000015 02/04          0.115     11     0.00
02/04 OR04B 6951          3   HORLICKS     BBSR=HD     9221000016 02/04          0.132     10     0.00
02/04 OR04B 6951          3   MAIN LINE,PP BBSR=HD     9221000017 02/04          2.722    222     0.00
02/04 OR04B 6951          3   HORLICKS     BBSR=HD     9221000018 02/04          0.826     62     0.00
02/04 OR04B 6951          3   TEA & FOODS  BBSR=HD     9221000019 02/04          1.422    120     0.00
02/04 OR04B 6951          3   MAIN LINE,PP BBSR=HD     9221000020 02/04          0.874     56     0.00
                                                                    TOTAL :    6.444    539     0.00  8643.00     0.00         8643.00     0.00      0.00 18/05 --         WITH 31.03.2022.   /         
02/04 OR05AH 7275         4   HORLICKS     JHARSUGUDA  9221000031 02/04          0.011      1     0.00
02/04 OR05AH 7275         4   MAIN LINE,PP JHARSUGUDA  9221000032 02/04          6.540    551     0.00
02/04 OR05AH 7275         4   TEA & FOODS  JHARSUGUDA  9221000033 02/04          0.583     42     0.00
02/04 OR05AH 7275         4   HORLICKS     JHARSUGUDA  9221000034 02/04          0.437     37     0.00
02/04 OR05AH 7275         4   PP           JHARSUGUDA  9221000035 02/04          0.002      2     0.00
                                                                    TOTAL :    7.573    633     0.00 23200.00     0.00         9200.00     0.00      0.00 09/05 --         WITH 31.03.2022.   /         
02/04 OR05AU 6579         5   MAIN LINE,PP  CUTTACK    9221000023 02/04          1.238    175     0.00
02/04 OR05AU 6579         5   HORLICKS      CUTTACK    9221000024 02/04          0.223     17     0.00
02/04 OR05AU 6579         5   TEA & FOODS   CUTTACK    9221000025 02/04          0.134     12     0.00
                                                                    TOTAL :    1.595    204     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
02/04 OD05AJ 9468         6   MAIN LINE,PP  CUTTACK    9221000012 02/04          3.266    319     0.00
                                                                    TOTAL :    3.266    319     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
02/04 OR02M 8981          7   HORLICKS     HINJILCUT   9221000036 02/04          0.007      1     0.00
02/04 OR02M 8981          7   MAIN LINE,PP HINJILCUT   9221000037 02/04          5.003    434     0.00
02/04 OR02M 8981          7   TEA & FOODS  HINJILCUT   9221000038 02/04          0.275     26     0.00
02/04 OR02M 8981          7   HORLICKS     HINJILCUT   9221000039 02/04          0.314     23     0.00
02/04 OR02M 8981          7   MAIN LINE    HINJILCUT   9221000040 02/04          0.599     50     0.00
                                                                    TOTAL :    6.198    534     0.00  7408.00     0.00         7408.00     0.00      0.00 18/05 --         WITH 31.03.2022.   /         
04/04 OR05D 4611          8   HORLICKS      CUTTACK    9221000048 04/04          0.025      2     0.00
04/04 OR05D 4611          8   MAIN LINE,PP  CUTTACK    9221000049 04/04          2.208    239     0.00
04/04 OR05D 4611          8   TEA & FOODS   CUTTACK    9221000050 04/04          0.077      7     0.00
04/04 OR05D 4611          8   HORLICKS      CUTTACK    9221000051 04/04          0.318     23     0.00
                                                                    TOTAL :    2.628    271     0.00     0.00   530.00            0.00     0.00      0.00   /                                 /         
04/04 OR05AM 3051         9   HORLICKS     SALEPUR     9221000069 04/04          0.007      1     0.00
04/04 OR05AM 3051         9   MAIN LINE,PP SALEPUR     9221000070 04/04          3.315    316     0.00
04/04 OR05AM 3051         9   HORLICKS     SALEPUR     9221000071 04/04          0.333     24     0.00
04/04 OR05AM 3051         9   TEA & FOODS  SALEPUR     9221000072 04/04          0.280     21     0.00
04/04 OR05AM 3051         9   HORLICKS     SALEPUR     9221000073 04/04          0.028      2     0.00
                                                                    TOTAL :    3.963    364     0.00  1800.00  1030.00          770.00     0.00      0.00 10/05 --                            /         
04/04 OR05AF 9678        10   HORLICKS     CUTTACK-JD  9221000044 04/04          0.024      3     0.00
04/04 OR05AF 9678        10   MAIN LINE,PP CUTTACK-JD  9221000045 04/04          1.393    131     0.00
04/04 OR05AF 9678        10   TEA & FOODS  CUTTACK-JD  9221000046 04/04          0.203     12     0.00
04/04 OR05AF 9678        10   HORLICKS     CUTTACK-JD  9221000047 04/04          1.730     18     0.00
                                                                    TOTAL :    3.350    164     0.00     0.00     0.00            0.00     0.00      0.00   /              WITH 31.03.2022.   /         
04/04 OD05Z 6316         11   HORLICKS     KONARK      9221000062 04/04          0.034      4     0.00
04/04 OD05Z 6316         11   MAIN LINE,PP KONARK      9221000063 04/04         10.740    804     0.00
04/04 OD05Z 6316         11   TEA & FOODS  KONARK      9221000064 04/04          0.327     15     0.00
04/04 OD05Z 6316         11   HORLICKS     KONARK      9221000065 04/04          0.226     16     0.00
                                                                    TOTAL :   11.327    839     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
04/04 OR04B 6951         12   MAIN LINE    K.NAGAR     9221000053 04/04          4.384    351     0.00
04/04 OR04B 6951         12   HORLICKS     K.NAGAR     9221000052 04/04          0.069      5     0.00
04/04 OR04B 6951         12   KISSAN       K.NAGAR     9221000054 04/04          0.069      3     0.00
                                                                    TOTAL :    4.522    359     0.00  8644.00     0.00         8644.00     0.00      0.00 18/05 --         WITH 31.03.2022.   /         
04/04 OR04D 9934         13   HORLICKS     KHURDA      9221000056 04/04          0.023      2     0.00
04/04 OR04D 9934         13   HORLICKS     KHURDA      9221000057 04/04          0.014      2     0.00
04/04 OR04D 9934         13   HORLICKS     KHURDA      9221000058 04/04          0.079      7     0.00
04/04 OR04D 9934         13   MAIN LINE,PP KHURDA      9221000059 04/04          7.063    534     0.00
04/04 OR04D 9934         13   HORLICKS     KHURDA      9221000060 04/04          0.155     11     0.00
04/04 OR04D 9934         13   TEA & FOODS  KHURDA      9221000061 04/04          0.509     37     0.00
                                                                    TOTAL :    7.843    593     0.00  8259.00     0.00         8259.00     0.00      0.00 18/05 --                            /         
04/04 OD05W 2534         14   TEA & FOODS   BHUBANESWA 9221000066 04/04          1.310    120     0.00
04/04 OD05W 2534         14   MAIN LINE     BHUBANESWA 9221000067 04/04          1.823    145     0.00
04/04 OD05W 2534         14   TEA & COFFEE  BHUBANESWA 9221000068 04/04          0.273     55     0.00
04/04 OD05W 2534         14   MAIN LINE     BHUBANESWA 9221000082 04/04          0.815     65     0.00
                                                                    TOTAL :    4.221    385     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
04/04 OR05AA 8887        15   MAIN LINE    RAGHUNATHPU 9221000078 04/04         14.109    916     0.00
04/04 OR05AA 8887        15   HORLICKS     RAGHUNATHPU 9221000079 04/04          0.027      2     0.00
04/04 OR05AA 8887        15   KISSAN       RAGHUNATHPU 9221000080 04/04          0.013      1     0.00
                                                                    TOTAL :   14.149    919     0.00  8468.00  1070.00         7398.00     0.00      0.00 18/05 --         WITH 31.03.2022.   /         
04/04 OR05AB 2212        16   HORLICKS     BALESORE    9221000074 04/04          0.044      4     0.00
04/04 OR05AB 2212        16   HORLICKS     BALESORE    9221000075 04/04          0.282     20     0.00
04/04 OR05AB 2212        16   MAIN LINE,PP BALESORE    9221000076 04/04         13.542   1054     0.00
04/04 OR05AB 2212        16   TEA & FOODS  BALESORE    9221000077 04/04          0.727     48     0.00
04/04 OR05AB 2212        16   PP           BALESORE    9221000081 04/04          0.010      3     0.00
                                                                    TOTAL :   14.605   1129     0.00 12410.00     0.00        12410.00  1000.00      0.00 13/05 --                            /         
04/04 OR05AB 6981        17   MAIN LINE    KHURDA REL  9221000093 04/04          4.426    294     0.00
04/04 OR05AB 6981        18   PP           KHURDA REL  9221000092 04/04          0.088      7     0.00
04/04 OR05AB 6981        19   HORLICKS     KHURDA REL  9221000091 04/04          3.564    261     0.00
04/04 OR05AB 6981        20   PP           KHURDA REL  9221000090 04/04          0.350     28     0.00
04/04 OR05AB 6981        21   MAIN LINE,PP KHURDA REL  9221000089 04/04          2.981    386     0.00
04/04 OR05AB 6981        22   HORLICKS     KHURDA REL  9221000088 04/04          0.006      1     0.00
04/04 OR05AB 6981        23   HORLICKS     KHURDA REL  9221000087 04/04          0.026      2     0.00
04/04 OR05AB 6981        24   HORLICKS     KHURDA REL  9221000086 04/04          0.131     12     0.00
04/04 OR05AB 6981        25   HORLICKS     KHURDA REL  9221000085 04/04          0.006      1     0.00
                                                                    TOTAL :   11.578    992     0.00  7520.00   860.00         2260.00     0.00      0.00 18/05 --                            /         
04/04 OR05AJ 2881        26   PP           KHURDA REL  9221000098 04/04          0.664     51     0.00
04/04 OR05AJ 2881        27   PP           KHURDA REL  9221000097 04/04          0.028     22     0.00
04/04 OR05AJ 2881        28   HORLICKS     KHURDA REL  9221000096 04/04          0.183     20     0.00
04/04 OR05AJ 2881        29   HORLICKS     KHURDA REL  9221000095 04/04          3.565    246     0.00
04/04 OR05AJ 2881        30   MAIN LINE,PP KHURDA REL  9221000094 04/04          7.318    802     0.00
                                                                    TOTAL :   11.758   1141     0.00  7520.00  1060.00         2060.00     0.00      0.00 18/05 --                            /         
04/04 OD05W 8714         31   MAIN LINE    SALEPUR     9221000083 04/04          1.602     90     0.00
04/04 OD05W 8714          9   MAIN LINE,PP SALEPUR     9221000070 04/04          2.800    280     0.00
                                                                    TOTAL :    4.402    370     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
04/04 OD05Z 6320         32   MAIN LINE    JARKA       9221000135 04/04          3.727    341     0.00
04/04 OD05Z 6320         32   TEA & COFFEE JARKA       9221000136 04/04          0.036      2     0.00
04/04 OD05Z 6320         32   MAIN LINE    JARKA       9221000137 04/04          4.463    330     0.00
                                                                    TOTAL :    8.226    673     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
04/04 OR05AF 9678        33   TEA & FOODS   BHUBANESWA 9221000140 04/04          1.247    102     0.00
04/04 OR05AF 9678        33   KISSAN        BHUBANESWA 9221000141 04/04          0.770     55     0.00
                                                                    TOTAL :    2.017    157     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
04/04 OD05AT 8708        34   LAKME        SAMBALPUR   9221000109 04/04          0.003      7     0.00
04/04 OD05AT 8708        34   LAKME        SAMBALPUR   9221000121 04/04          0.000      1     0.00
04/04 OD05AT 8708        35   HORLICKS     SAMBALPUR   9221000107 04/04          0.076      8     0.00
04/04 OD05AT 8708        35   HORLICKS     SAMBALPUR   9221000108 04/04          0.111      8     0.00
04/04 OD05AT 8708        35   HORLICKS     SAMBALPUR   9221000110 04/04          0.559     43     0.00
04/04 OD05AT 8708        35   MAIN LINE,PP SAMBALPUR   9221000111 04/04          5.684    429     0.00
04/04 OD05AT 8708        35   TEA & FOODS  SAMBALPUR   9221000112 04/04          1.478     99     0.00
04/04 OD05AT 8708        35   HORLICKS     SAMBALPUR   9221000113 04/04          0.216     18     0.00
04/04 OD05AT 8708        35   MAIN LINE    SAMBALPUR   9221000114 04/04          0.101     10     0.00
04/04 OD05AT 8708        36   HORLICKS     HIRAKUDA    9221000103 04/04          0.029      3     0.00
04/04 OD05AT 8708        36   MAIN LINE,PP HIRAKUDA    9221000104 04/04          7.776    680     0.00
04/04 OD05AT 8708        36   TEA & FOODS  HIRAKUDA    9221000105 04/04          0.746     40     0.00
04/04 OD05AT 8708        36   HORLICKS     HIRAKUDA    9221000106 04/04          0.229     16     0.00
04/04 OD05AT 8708        36   PP           HIRAKUDA    9221000115 04/04          0.002      2     0.00
04/04 OD05AT 8708        36   MAIN LINE    HIRAKUDA    9221000122 04/04          1.833    220     0.00
                                                                    TOTAL :   18.843   1584     0.00 24000.00  2000.00        22000.00     0.00      0.00 04/05 --                            /         
04/04 OR07X 3679         37   HORLICKS     ASKA        9221000116 04/04          0.007      1     0.00
04/04 OR07X 3679         37   MAIN LINE,PP ASKA        9221000117 04/04          9.940    787     0.00
04/04 OR07X 3679         37   TEA & FOODS  ASKA        9221000118 04/04          0.277     18     0.00
04/04 OR07X 3679         37   MAIN LINE    ASKA        9221000119 04/04          2.652    170     0.00
04/04 OR07X 3679         37   HORLICKS     ASKA        9221000120 04/04          1.459    103     0.00
                                                                    TOTAL :   14.335   1079     0.00 13600.00 10000.00         3600.00     0.00      0.00 01/06 --                   850*16   /         
04/04 OR05Y 8291         38   MAIN LINE    BALANGIR    9221000132 04/04          9.729    906     0.00
04/04 OR05Y 8291         38   KISSAN       BALANGIR    9221000133 04/04          0.024      1     0.00
04/04 OR05Y 8291         38   HORLICKS     BALANGIR    9221000134 04/04          0.549     41     0.00
                                                                    TOTAL :   10.302    948     0.00     0.00  5000.00            0.00     0.00      0.00   /                                 /         
04/04 OD05Z 0825         39   HORLICKS     NUAPATNA    9221000099 04/04          0.061      5     0.00
04/04 OD05Z 0825         39   MAIN LINE,PP NUAPATNA    9221000100 04/04          7.981    729     0.00
04/04 OD05Z 0825         39   HORLICKS     NUAPATNA    9221000101 04/04          0.769     58     0.00
04/04 OD05Z 0825         39   TEA & FOODS  NUAPATNA    9221000102 04/04          0.216     13     0.00
                                                                    TOTAL :    9.027    805     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
04/04 OR09G 1563         40   MAIN LINE    TANGI,KHURD 9221000128 04/04          1.593    140     0.00
04/04 OR09G 1563         40   HORLICKS     TANGI,KHURD 9221000129 04/04          0.013      1     0.00
04/04 OR09G 1563         40   TEA & FOODS  TANGI,KHURD 9221000130 04/04          0.057     10     0.00
04/04 OR09G 1563         41   HORLICKS     CHATRAPUR   9221000123 04/04          0.080      8     0.00
04/04 OR09G 1563         41   HORLICKS     CHATRAPUR   9221000124 04/04          0.006      1     0.00
04/04 OR09G 1563         41   MAIN LINE,PP CHATRAPUR   9221000125 04/04         10.452    983     0.00
04/04 OR09G 1563         41   TEA & FOODS  CHATRAPUR   9221000126 04/04          0.429     40     0.00
04/04 OR09G 1563         41   HORLICKS     CHATRAPUR   9221000127 04/04          1.057     79     0.00
04/04 OR09G 1563         41   MAIN LINE    CHATRAPUR   9221000138 04/04          1.468    100     0.00
                                                                    TOTAL :   15.155   1362     0.00 13280.00 10000.00         3280.00     0.00      0.00   /                        830*16   /         
04/04 OD05Z 0824         42   HORLICKS     S.BALANDA   9221000144 04/04          0.021      2     0.00
04/04 OD05Z 0824         42   MAIN LINE,PP S.BALANDA   9221000145 04/04          9.124    755     0.00
04/04 OD05Z 0824         42   HORLICKS     S.BALANDA   9221000146 04/04          0.123      9     0.00
04/04 OD05Z 0824         42   TEA & FOODS  S.BALANDA   9221000147 04/04          0.070      4     0.00
04/04 OD05Z 0824         42   TEA & FOODS  S.BALANDA   9221000148 04/04          0.301     20     0.00
04/04 OD05Z 0824         42   HORLICKS     S.BALANDA   9221000149 04/04          0.340     25     0.00
04/04 OD05Z 0824         42   TEA & COFFEE S.BALANDA   9221000150 04/04          0.127      6     0.00
                                                                    TOTAL :   10.106    821     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
04/04 OD15T 1811         43   MAIN LINE    SAMBALPUR   9221000151 04/04          6.455    451     0.00
04/04 OD15T 1811         43   MAIN LINE    SAMBALPUR   9221000152 04/04          8.785    490     0.00
                                                                    TOTAL :   15.240    941     0.00 18400.00 10000.00         8400.00     0.00      0.00 06/05 --                            /         
04/04 OR05AL 8899        44   MAIN LINE    KHURDA REL  9221000153 04/04         16.488   1091     0.00
04/04 OR05AL 8899        45   MAIN LINE    KHURDA REL  9221000154 04/04          0.015      2     0.00
                                                                    TOTAL :   16.503   1093     0.00     0.00  1600.00            0.00     0.00      0.00   /                                 /         
04/04 OD05AX 1508        46   MAIN LINE    TITILAGARH  9221000139 04/04          7.597    480     0.00
04/04 OD05AX 1508        47   MAIN LINE    RAJAKHARIAR 9221000142 04/04          1.500    120     0.00
04/04 OD05AX 1508        48   MAIN LINE    BONGOMUNDA  9221000143 04/04          2.024     80     0.00
                                                                    TOTAL :   11.121    680     0.00 33000.00  2500.00        30500.00     0.00      0.00 04/05 --          WITH 31.03.2022   /         
04/04 OD05W 8714         49   HORLICKS     JATNI       9221000155 04/04          0.021      2     0.00
04/04 OD05W 8714         49   MAIN LINE,PP JATNI       9221000156 04/04          2.921    262     0.00
04/04 OD05W 8714         49   HORLICKS     JATNI       9221000157 04/04          0.528     39     0.00
04/04 OD05W 8714         49   TEA & FOODS  JATNI       9221000158 04/04          0.543     44     0.00
                                                                    TOTAL :    4.013    347     0.00     0.00     0.00            0.00     0.00      0.00   /                                 /         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                             REPORT TOTAL :  269.134  21816       0.00196152.00  45650.00      134832.00   1000.00      0.00
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


DO setout WITH "Despatch Register"
headpnm= "pghead"
footpnm= "footer"
endpnm = "resetrepo"
IF !outdev()
	RETU .F.
ENDIF
msdate = _sdate
medate=IIF(BETW(DATE(), _sdate, _edate), DATE(), _edate)
m.proceed = .F.
DO desreg.spr
IF m.proceed
	IF desorder="Areawise" OR desorder="Companywise" OR desorder="Bill-no wise" OR desorder="L/C No wise" OR desorder="Vehicle-wise"
		cstr = ""
		=ophelp("company.name", "company.code", "-Ocompname-P")
		DO strcomp
	ENDIF
	printatpos = 70
	IF desorder="Vehicle-wise"
		SELE DIST vehno, .F. AS consider FROM bill INTO TABLE vehtab
		SELE vehtab
		INDEX ON vehno TAG vehno
		=ophelp("vehtab.vehno")
		vehopt = vehtab.vehno
		=closedbf("vehtab", "-")
		printatpos = printatpos - 29
	ENDIF
	IF desorder="Areawise"
		acode = ""
		=ophelp("area.name", "area.code", "-Oareaname-P")
		DO strarea
	ENDIF
	IF setrepo()
		heading = heading()
		DO pghead
		DO printrep
		DO lastfoot
	ENDIF
ENDIF
RELE destype, desorder, destruck, desdd
DO resetout
RETU .T.

FUNC strarea
SELE area
SET FILTER TO consider
GO TOP
acode = ""
SCAN WHILE !EOF()
	acode = acode + area.code + "|"
ENDSCAN
SET FILTER TO
RETU

FUNC setrepo
SET ORDER TO areacode IN area
SET ORDER TO compcode IN company
wcond = IIF(EMPT(destype), " .T. ", " s.ownveh=destype ")
IF desorder="Vehicle-wise"
	wcond = wcond + " AND s.vehno=vehopt"
ENDIF
IF desorder="Areawise"
	wcond = wcond + " AND sd.area$acode"
ENDIF
IF desorder="Areawise" OR desorder="Companywise" OR desorder="Bill-no wise" OR desorder="L/C No wise" OR desorder="Vehicle-wise"
	wcond = wcond + " AND sd.company$cstr"
	DO CASE
	CASE desorder="Bill-no wise"
		ocond = "sd.bno, sd.bnodate, sd.invno, sd.no"
	CASE desorder="Companywise"
		ocond = "sd.bnodate, sd.invno, sd.no"
	CASE desorder="L/C No wise"
		ocond = "sd.invno, sd.idate, sd.bnodate, sd.no"
	CASE desorder="Vehicle-wise"
 		ocond = "sd.idate, sd.invno, sd.no"
	CASE desorder="Areawise"
 		ocond = "sd.idate, sd.invno, sd.no"
	ENDCASE
ELSE
	ocond = "sd.idate, sd.invno, sd.no"
ENDIF
SELE s.vehno, s.tfreight, s.advance, s.vno, s.balance, s.unload+s.detaintion+s.epoint+s.chanda+s.other AS other, ;
	 s.odate, s.ovno, s.narration, s.tdsamt, sd.* ;
	FROM bill s, billdet sd ;
	WHERE s.invno=sd.invno AND BETW(s.idate,msdate,medate) AND &wcond ;
	ORDER BY &ocond ;
	INTO CURSOR desreg
SET RELA TO area INTO area, company INTO company
GO TOP
RETU !EOF()

FUNC resetrepo
=closedbf("desreg", "-")
RETU .T.

FUNC heading
IF desorder="Vehicle-wise"
	retdata = "Date  Lc No   Destination Inv No     Date  LR No   Weight    Qty"
ELSE
	retdata = "Date  Truck No        Lc No   Company      Destination Inv No     Date  LR No   Weight    Qty"
ENDIF
retdata = retdata + IIF(_super,"  Freight","")
retdata = retdata + IIF(destruck," Truck Fr  Advance  V.No   Balance    Other   TDS AMT  V.Dt  V.No ","")
retdata = retdata + " Remark              "
retdata = retdata + IIF(desdd, " Deli  Ack.  ","")
RETU retdata

FUNC pghead
?_company
?REPL("_",80)
?"DESPATCH REGISTER FOR "
IF desorder="Companywise" OR desorder="Bill-no wise" OR desorder="L/C No wise" OR desorder="Vehicle-wise"
	?? ALLT(company.name)+" "
ENDIF
IF desorder="Areawise"
	?? ALLT(area.name)+" "
ENDIF
IF desorder="Vehicle-wise"
	?? "FOR VEHICLE NO: ", vehopt
ELSE
	?? IIF(destype=" ", "ALL VEHICLES", IIF(destype="O", "OWN VEHICLES", IIF(destype="H", "HIRED VEHICLES", "")))
ENDIF
IF desorder="Bill-no wise" 
	?? "(BILL DATE/NO WISE)"
ENDIF
IF desorder="L/C No wise"
	?? "(LOADING CHART WISE)"
ENDIF
?"PERIOD", msdate, "TO", medate, "" 
?
?heading
?REPL("-",LEN(heading))
?
RETU .T.

FUNC printrep
GO TOP
STORE 0 TO rwt, rqty, rfr, rtfr, radv, rbal, roth, rtdsamt
DO WHILE !EOF()
	STORE 0 TO twt, tqty, tfr
	grp1 = DTOS(idate)+invno
	DO WHILE grp1 = DTOS(idate)+invno AND !EOF()
		IF desorder="Vehicle-wise"
			?LEFT(DTOC(idate),5), PADL(ALLT(no),5), loading, ;
			 PADL(area.name,11), bno, LEFT(DTOC(bnodate),5), PADL(ALLT(lrno),6), ;
			 weight PICT "999.999", qty PICT "999999"
		ELSE
			?LEFT(DTOC(idate),5), vehno, PADL(ALLT(no),5), loading, LEFT(company.name,12), ;
			 PADL(area.name,11), bno, LEFT(DTOC(bnodate),5), PADL(ALLT(lrno),6), ;
			 weight PICT "999.999", qty PICT "999999"
		ENDIF
		twt = twt + weight
		tqty = tqty + qty
		rwt = rwt + weight
		rqty = rqty + qty
		IF _super
			??freight PICT "999999.99"
			tfr = tfr + freight
		ENDIF
		SKIP
	ENDDO
	SKIP -1
	?CHR(27)+CHR(71), "TOTAL :" AT printatpos, twt PICT "9999.999", tqty PICT "999999"
	IF _super
		??tfr PICT "999999.99"
	ENDIF
	IF destruck
		??tfreight PICT "999999.99", advance PICT "99999.99", ;
		  vno, balance PICT "99999.99", other PICT "99999.99", ;
		  IIF(TYPE("tdsamt")="N", tdsamt, 0) PICT "999999.99", ;
		  LEFT(DTOC(odate),5), ovno
	ENDIF
	?? " "+PADL(narration, 20)
	IF desdd
		??" "+LEFT(DTOC(ddate),5), LEFT(ack,6)
	ENDIF
	??CHR(27)+CHR(72)
	rfr = rfr + tfr
	rtfr = rtfr + tfreight
	radv = radv + advance
	rbal = rbal + balance
	roth = roth + other
	rtdsamt = rtdsamt + IIF(TYPE("tdsamt")="N", tdsamt, 0)
	SKIP
ENDDO
?REPL("-",LEN(heading))
?"REPORT TOTAL :" AT printatpos-9, rwt PICT "9999.999", rqty PICT "999999"
IF _super
	??rfr PICT "99999999.99"
ENDIF
IF destruck
	??rtfr PICT "999999.99", radv PICT "999999.99", ;
	  rbal PICT "99999999999.99", roth PICT "999999.99", ;
 	  rtdsamt PICT "999999.99"
ENDIF
?REPL("-",LEN(heading))
?
RETU .T.
